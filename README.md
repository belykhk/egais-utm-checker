# egais-utm-checker
Небольшой скрипт на bash, проверяющий действительность сертификатов ЕГАИС УТМ и отправляющий результаты на почту.

Для работы потребуется наличие:
 - curl
 - ssmtp (уже настроенный)
 - crontab (или его аналог)

Установка:
 - git clone https://github.com/belykhk/egais-utm-checker
 - изменить в файле utm.sh переменные "path" и "mailaddress" на подходящие
 - в файле utm_list.csv добавить адреса и название всех серверов с установленным ЕГАИС УТМ
 - добавить в крон запись, которая будет запускать данный скрипт, например "0 9 * * 5 bash //home/foo/egais-utm-checker/utm.sh"

Работа скрипта проверена в Debian Stretch. С OS X не будет работать из-за особенностей работы "let".

Примерный вид получаемого письма:
```
 Время проверки: 2018-02-26 14:02:58 +0400

 Заведение 1
 Версия УТМ 2.0.5
 PKI: FSRAR-RSA-131321312321_2 действителен по 2018-12-10 17:14:58 +0400 - Действителен
 До окончания PKI сертификата осталось: 287 дней
 ГОСТ: 1232135443_23423425 действителен по 2018-04-26 11:27:06 +0400 - Действителен
 До окончания ГОСТ сертификата осталось: 58 дней

 Заведение 2
 Версия УТМ 2.1.6
 PKI: Действителен по 2018-04-19 12:31:26 +0400
 До окончания PKI сертификата осталось: 51 дней
 ГОСТ: Действителен по 2018-07-19 09:08:48 +0400
 До окончания ГОСТ сертификата осталось: 142 дней
```
